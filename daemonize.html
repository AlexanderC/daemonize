<!-- Creator     : groff version 1.21 -->
<!-- CreationDate: Wed Jun  1 09:19:38 2011 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>daemonize</title>

</head>
<body>

<h1 align="center">daemonize</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#LICENSE">LICENSE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHOR">AUTHOR</a><br>
<a href="#CONTRIBUTORS">CONTRIBUTORS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">daemonize
&minus; run a program as a Unix daemon</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>daemonize</b>
[-a] [-c <i>directory</i>] [-e <i>stderr</i>] [-o
<i>stdout</i>] [-p <i>pidfile</i>] [-l <i>lockfile</i>] [-u
<i>user</i>] [-v] <i>path [arg] ...</i></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i><b>daemonize</b></i>
runs a command as a Unix daemon. As defined in W. Richard
Stevens&rsquo; 1990 book, <i>Unix Network Programming</i>
(Addison-Wesley, 1990), a daemon is &ldquo;a process that
executes &rsquo;in the background&rsquo; (i.e., without an
associated terminal or login shell) either waiting for some
event to occur, or waiting to perform some specified task on
a periodic basis.&rdquo; Upon startup, a typical daemon
program will:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>o</p></td>
<td width="2%"></td>
<td width="86%">


<p>Close all open file descriptors (especially standard
input, standard output and standard error)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>o</p></td>
<td width="2%"></td>
<td width="86%">


<p>Change its working directory to the root filesystem, to
ensure that it doesn&rsquo;t tie up another filesystem and
prevent it from being unmounted</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>o</p></td>
<td width="2%"></td>
<td width="86%">


<p>Reset its <i>umask</i> value</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>o</p></td>
<td width="2%"></td>
<td width="86%">


<p>Run in the background (i.e., <i>fork</i>)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>o</p></td>
<td width="2%"></td>
<td width="86%">


<p>Disassociate from its process group (usually a shell),
to insulate itself from signals (such as HUP) sent to the
process group</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>o</p></td>
<td width="2%"></td>
<td width="86%">


<p>Ignore all terminal I/O signals</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>o</p></td>
<td width="2%"></td>
<td width="86%">


<p>Disassociate from the control terminal (and take steps
not to reacquire one)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>o</p></td>
<td width="2%"></td>
<td width="86%">


<p>Handle any <small>SIGCLD</small> signals</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Most programs
that are designed to be run as daemons do that work for
themselves. However, you&rsquo;ll occasionally run across
one that does not. When you must run a daemon program that
does not properly make itself into a true Unix daemon, you
can use <b>daemonize</b> to force it to run as a true
daemon.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p style="margin-top: 1em">-a</p></td>
<td width="8%"></td>
<td width="78%">


<p style="margin-top: 1em">Append to the output files,
rather than overwriting them (which is the default). Only
applicable if <i>-e</i> and/or <i>-o</i> are specified.</p></td></tr>
</table>

<p style="margin-left:11%;">-c <i>directory</i></p>

<p style="margin-left:22%;">Specifies the directory to
which to change before running the program. Defaults to
&quot;/&quot;. The choice for this option is important. The
file system containing the daemon&rsquo;s working directory
cannot be unmounted while the daemon is running.
That&rsquo;s why most daemons are careful to use a working
directory on the root file system.</p>

<p style="margin-left:11%;">-e <i>stderr</i></p>

<p style="margin-left:22%;">Redirect standard error to the
specified file, instead of &quot;/dev/null&quot;.</p>


<p style="margin-left:22%; margin-top: 1em"><b>Warning:</b>
Be careful where you redirect the output! The file system
containing the open file cannot be unmounted as long as the
file is open. For best results, make sure that this output
file is on the same file system as the daemon&rsquo;s
working directory. (See the <i>-c</i> option.)</p>

<p style="margin-left:11%;">-E <i>name=value</i></p>

<p style="margin-left:22%;">Add an environment variable to
the environment the daemon will see. The parameter must be
of the form <i>name=value.</i> This parameter may be
specified multiple times.</p>

<p style="margin-left:11%;">-o <i>stdout</i></p>

<p style="margin-left:22%;">Redirect standard output to the
specified file, instead of &quot;/dev/null&quot;.</p>


<p style="margin-left:22%; margin-top: 1em"><b>Warning:</b>
Be careful where you redirect the output! The file system
containing the open file cannot be unmounted as long as the
file is open. For best results, make sure that this output
file is on the same file system as the daemon&rsquo;s
working directory. (See the <i>-c</i> option.)</p>

<p style="margin-left:11%;">-p <i>pidfile</i></p>

<p style="margin-left:22%;">Causes <b>daemonize</b> to
write the numeric process ID (PID) of the running daemon to
the specified file. This option is useful when the program
being daemonized doesn&rsquo;t create its own PID file.</p>

<p style="margin-left:11%;">-l <i>lockfile</i></p>

<p style="margin-left:22%;">Single-instance checking.
Causes <b>daemonize</b> to ensure that no more than one
instance of the daemon is running by placing an exclusive
lock on given lockfile. If another process already has a
lock on the lockfile, <i>daemonize</i> exits.</p>

<p style="margin-left:11%; margin-top: 1em">It <i>is</i>
possible to use the <i>pidfile</i> as the lock file (e.g.,
&quot;-p /var/run/foo -l /var/run/foo&quot;), though typical
daemons use separate files.</p>

<p style="margin-left:11%; margin-top: 1em">NOTE: If the
executed program decides to close all file descriptors, the
single-instance locking will not work, since the lock
depends on an open file descriptor. (The operating system
kernel removes the lock once the process holding the lock
closes the file or exits.) Normal processes that do not
daemonize themselves do not usually close all file
descriptors. <br>
-u <i>user</i></p>

<p style="margin-left:22%;">Run the program as the
specified user. This option only works if <b>daemonize</b>
is invoked by the superuser. Note: For obvious reasons,
it&rsquo;s very dangerous to install <b>daemonize</b> as a
<i>setuid-to-root</i> executable. For that reason,
<b>daemonize</b> will refuse to run if it detects that it
has been installed that way.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>-v</p></td>
<td width="8%"></td>
<td width="78%">


<p>Cause <b>daemonize</b> to write verbose messages to
standard error, telling what it&rsquo;s doing as it
daemonizes the program.</p></td></tr>
</table>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">If the host
operating system provides the <b>daemon</b>(3) library
routine, <b>daemonize</b> will use it. Otherwise,
<b>daemonize</b> uses its own version of <b>daemon</b>(3).
This choice is made at compile time. (BSD 4.4-derived
operating systems tend to provide their own <b>daemon</b>(3)
routine.)</p>

<p style="margin-left:11%; margin-top: 1em">FreeBSD 5.0
introduced a <b>daemon</b>(1) command that is similar to,
but less functional, than <b>daemonize</b>.</p>

<h2>LICENSE
<a name="LICENSE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This program
released under a BSD-style license. For more details,
consult the LICENSE file accompanying the source
distribution, or visit
&quot;http://software.clapper.org/daemonize/LICENSE&quot;.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>daemon</b>(3),
<b>setsid</b>(2), <b>flock(2)</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>daemonize</b>
Home Page: http://software.clapper.org/daemonize/</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Brian M.
Clapper, <i>bmc &lt;at&gt; clapper &lt;dot&gt; org</i></p>

<h2>CONTRIBUTORS
<a name="CONTRIBUTORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Support for the
<i>-e</i> and <i>-o</i> options is based on a patch
submitted by Tim Starling <i>(tstarling &lt;at&gt; wikimedia
&lt;dot&gt; org).</i></p>

<p style="margin-left:11%; margin-top: 1em">Support for the
<i>-l</i> option is based on a patch submitted by Yakov
Lerner <i>(iler.ml &lt;at&gt; gmail &lt;dot&gt;
com).</i></p>
<hr>
</body>
</html>
